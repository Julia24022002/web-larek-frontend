# Проектная работа "Веб-ларек"

## Описание

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Документация

### Данные и типы данных, используемые в приложении

- Интерфейс данных для товара

```typescript
interface IProduct {
	id: string; // уникальный id
	category: TCategoryType; // категория товара
	title: string; // название  товара
	image: string; // ссылка на изображение товара
	price: number | null; // цена товара, может быть null
	description?: string; // описание товара
	inBasket?: boolean; // добавлен товар в корзину
}
```

- Интерфейс данных заказа

```typescript
interface IOrder {
	payment: TPayment; // Способ оплаты
	address: string; // Адрес доставки
	email: string; // Электронная почта
	phone: string; // Телефон
}
```

- Данные для корзины с товарами

```typescript
interface IBasket {
	items: TProductInBasket[]; // список товаров
	total: number; // стоимость заказа
}
```

- Данные успешного ответа от сервера при отправке заказа

```typescript
interface IOrderResult {
	id: string;
	total: number;
}
```

- Данные для каталога товара

```typescript
interface IProductList {
	items: IProduct[];
	preview: string | null;
}
```

- Тип описывающий категории товаров

```typescript
type TCategoryType =
	| 'софт-скил'
	| 'другое'
	| 'дополнительное'
	| 'кнопка'
	| 'хард-скил';
```

- Тип для товара в корзине

```typescript
type TCardBasket = Pick<IProduct, 'id' | 'title' | 'price'> & { index: number };
```

- Тип способа оплаты

```typescript
type TPayment = 'cash' | 'card';
```

- Тип модального окна выбора способа оплаты и ввода адреса

```typescript
type TDeliveryInfo = Pick<IOrder, 'payment' | 'address'>;
```

- Тип модального окна ввод почты и телефона

```typescript
type TContactsInfo = Pick<IOrder, 'email' | 'phone'>;
```

- Тип для общей суммы заказа

```typescript
type TTotalPrice = Pick<IBasket, 'total'>;
```

### Архитекрута приложения

Код приложения разделен на слои слогласно парадигме `MVP`:

- `Model`слой данных, отвечает за хранение и изменение данных.
- `View` слой представления, отвечает за отображения данных на странице.
- `Presenter` презентер, отвечает за связь представления и данных (src/index.ts)

### Базовый код

#### Класс `Api`

Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный обьект с заголовками запросов.

Поля:

- `baseUrl` - базовый адрес сервера
- `options` - объект с заголовками запросов

Методы:

- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с обьектом, которым ответил сервер.
- `post`- принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию
  выполняется POST" запрос, но метод запроса может быть переопределен заданием третьего
  параметра при вызове.

#### Класс `EventEmitter`

Брокер событий позволяет отправлять события и подписываться на события, происходящие в
системе. Класс используется в презентере для обработки событий и в слоях приложения для
генерации событий.

Основные методы, реализуемые классом описаны интерфейсом `IEvents`:

- `events` - переменная к которую будут кэшироваться события.
- `on()` - функция установки обработчика на событие.
- `off()` - функция снятия обработчика с события.
- `emit()` - функция инициирования события с данными.
- `onAll` - функция прослушивания всех событий.
- `offAll` - функция сброса всех обработчиков.
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

#### Абстрактный класс `Component`

Абстрактный базовый класс предназначен для создания компонентов пользовательского интерфейса. Класс обеспечивает инструментарий для управления DOM элементами и поведением компонента. Наследуется всеми классами представления(View)

`constructor(container: HTMLElement)`- принимает принимает родительский элемент.

Методы:

- `toggleClass` - переключает класс для переданного элемента.
- `setText` - устанавливает текстовое содержимое для переданного элемента.
- `setImage` - устанавливает изображения и альтернативный текст для изоображения для переданного элемента типа HTMLImageElement
- `setDisabled` - изменяет статус блокировки для переданного элемента.
- `setHidden` - скрывает переданный элемент.
- `setVisible` - отоброжает переданный элемент.
- `render` - рендерит компонент, используя переданные данные. Метод должен быть переназначен в дочерних классах.

#### Абстрактный класс `Model`

<!--  -->
<!--  -->
<!--  -->

## Слой данных (Model)

#### Класс `ProductData`

Класс отвечает за хранение и логику работы с данными товаров.

- поля:\
 `preview: string | null; ` - для просмотра выбранного товара в отдельном попапе

- конструктор:\
 

- методы:\
  `getProduct(productId: string): IProduct;` -получение выбранной карточки товара по id для просмотра\
  `setProducts(products: IProduct[]): void;` - принимает массив и обновляет свойство products

#### Класс `OrderData`

Отвечает за хранение и логику работы с данными при оформлении заказа (выбор способа оплаты, адрес доставки, email и телефон покупателя).

- поля:\
  `payment: TPayment` - способ оплаты \
  `address: string` - адрес доставки\
  `email: string` - email покупателя\
  `phone: string` - телефон покупателя

- конструктор:\

- методы:\

#### Класс `BasketData`

Наследует класс Modal. Отвечает за хранение и логику товаров, добавленных покупателем в корзину.

- поля:\
  `items` список id товаров заказа.\
  `total` стоимость заказанных товаров.

- конструктор:\

- методы:\

## Слой представления (View)

### "Общие" классы представления

#### Класс `Modal`

Класс для работы с модальными окнами, наследуется от класса Component (реализация слоя View). Класс используется для управления состоянием (открыт, закрыт) и отображением компонента (render) модального окна.

- `open(): void` - открытие модального окна
- `close(): void` - закрытие модального окна

#### Класс `Basket`

Класс для работы с корзиной, наследуется от класса Component (реализация слоя View). Класс используется для управления отображением данных (товаров, цены) в компоненте корзины

#### Класс `Form`

Класс для работы с формами, наследуется от класса Component (реализация слоя View). Класс используется для установки значения валидности и передачу ошибок в компонент, а также для отображения компонента (render) формы заполнения данных

#### Класс `Success`

Класс представления об успешном выполнении действия.

#### Классы представлений конкретного проекта:

#### Класс `Page`

Представляет компонент страницы с некоторыми элементами и функциональностью для управления ими.

#### Класс `Card`

Класс для управления отображением информации о продукте, наследуется от класса Component (реализация слоя View). Класс используется для управления отображением данных (название, картинка) в компоненте карточки товара

#### Класс `Order`

Наследует класс `Form<OrderForm>`. Представляет форму заказа с возможностью выбора способа оплаты. Конструктор класса, который принимает контейнер формы заказа container типа HTMLFormElement и объект событий events типа EventEmitter. В конструкторе вызывается конструктор родительского класса Form с переданным контейнером и объектом событий.

Содержит:

- `address` - Устанавливает адрес для доставки заказа.
- `payment` - Устанавливает выбранный метод оплаты и активирует соответствующую кнопку.

#### Класс `Contacts`

Представляет форму для ввода контактной информации (электронной почты и номера телефона) при оформлении заказа.

<!-- ### Описание событий  -->
